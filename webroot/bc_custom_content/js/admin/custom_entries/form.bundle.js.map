{"version":3,"file":"bc_custom_content/js/admin/custom_entries/form.bundle.js","mappings":";;;;;;;;;;AAaA,IAAMA,EAAoB,CAKtBC,QAAS,KAKTC,QAAO,WACHC,KAAKF,QAAUG,EAAE,iCAAiCC,KAAK,gBACvDF,KAAKG,gBACT,EAKAA,eAAc,WACVF,EAAE,eAAeG,MAAMJ,KAAKK,SAC5BJ,EAAE,eAAeG,MAAMJ,KAAKM,SAC5BL,EAAE,oBAAoBG,MAAMP,EAAkBU,WAClD,EAMAF,QAAO,WACHG,OAAOC,KAAK,GAAI,WAChB,IAAMC,EAAOT,EAAED,MAAMW,QAAQ,QACvBC,EAASF,EAAKR,KAAK,UACnBW,EAAaZ,EAAEa,OAAOC,aAAe,+BAAiClB,EAAkBC,QAAU,mBAClGkB,EAAWf,EAAEa,OAAOG,QAAU,kDAOpC,OANAP,EAAKR,KAAK,SAAU,WAAWA,KAAK,SAAUW,GAAYK,SAC1DR,EAAKR,KAAK,SAAU,SAASA,KAAK,SAAUU,GAE5CX,EAAEkB,IAAIH,GAAU,SAAUI,GACtBnB,EAAE,4BAA4BoB,IAAID,EACtC,KACO,CACX,EAKAd,QAAO,WACH,IAAIgB,EAAerB,EAAED,MAAME,KAAK,YAC5BqB,EAAQtB,EAAED,MAAME,KAAK,cACrBsB,EAAQvB,EAAE,eAAiBqB,GAAcE,QAE7CA,EAAMC,KAAK,mCAAmCC,MAAK,WAC/CzB,EAAED,MAAME,KAAK,OAAQD,EAAED,MAAME,KAAK,QAAQyB,QAAQ,eAAgBJ,SACxCK,IAAvB3B,EAAED,MAAME,KAAK,OACZD,EAAED,MAAME,KAAK,KAAMD,EAAED,MAAME,KAAK,MAAMyB,QAAQ,WAAYJ,GAElE,IAGAC,EAAMC,KAAK,SAASC,MAAK,WACrBzB,EAAED,MAAME,KAAK,MAAOD,EAAED,MAAME,KAAK,OAAOyB,QAAQ,WAAYJ,GAChE,IAEA,IAAMM,EAAK,WAAaP,EAAe,IAAMC,EAC7CC,EAAMtB,KAAK,KAAM2B,GACjBL,EAAMC,KAAK,oBAAoBC,MAAK,WAChCzB,EAAED,MAAME,KAAK,qBAAsB2B,GACnC5B,EAAED,MAAMI,MAAMP,EAAkBU,WACpC,IAEAN,EAAE,SAAWqB,GAAcQ,OAAON,GAClCA,EAAMO,UAAU,KAChB9B,EAAED,MAAME,KAAK,aAAc8B,OAAOT,GAAS,GAE3CtB,EAAE,IAAM4B,EAAK,4BAA4BI,SACzChC,EAAEa,OAAOoB,iBAAiB,IAAML,EAAK,qBACzC,EAKAtB,WAAU,WACD4B,QAAQ,8BAGblC,EAAE,IAAMA,EAAED,MAAME,KAAK,uBAAuBkC,QAAQ,KAAK,WACrDnC,EAAED,MAAMiC,QACZ,GACJ,GAIJpC,EAAkBE,S","sources":["webpack://bc-admin-third/./src/bc_custom_content/js/admin/custom_entries/form.js"],"sourcesContent":["/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) NPO baser foundation <https://baserfoundation.org/>\n *\n * @copyright     Copyright (c) NPO baser foundation\n * @link          https://basercms.net baserCMS Project\n * @since         5.0.0\n * @license       https://basercms.net/license/index.html MIT License\n */\n\n/**\n * Custom Entries Form\n */\nconst customEntriesForm = {\n\n    /**\n     * フルURL\n     */\n    fullUrl: null,\n\n    /**\n     * 初期化\n     */\n    mounted() {\n        this.fullUrl = $(\"#AdminCustomEntriesFormScript\").attr('data-fullUrl');\n        this.registerEvents();\n    },\n\n    /**\n     * イベント登録\n     */\n    registerEvents() {\n        $(\"#BtnPreview\").click(this.preview);\n        $(\"#BtnAddLoop\").click(this.addLoop);\n        $(\".btn-delete-loop\").click(customEntriesForm.deleteLoop);\n    },\n\n    /**\n     * プレビュー\n     * @returns {boolean}\n     */\n    preview() {\n        window.open('', 'preview');\n        const form = $(this).parents('form');\n        const action = form.attr('action');\n        const previewUrl = $.bcUtil.adminBaseUrl + 'baser-core/preview/view?url=' + customEntriesForm.fullUrl + '&preview=default';\n        const tokenUrl = $.bcUtil.baseUrl + '/baser-core/bc_form/get_token?requestview=false'\n        form.attr('target', 'preview').attr('action', previewUrl).submit();\n        form.attr('target', '_self').attr('action', action);\n\n        $.get(tokenUrl, function (result) {\n            $('input[name=\"_csrfToken\"]').val(result);\n        });\n        return false;\n    },\n\n    /**\n     * ループを追加する\n     */\n    addLoop() {\n        var srcFieldName = $(this).attr('data-src');\n        var count = $(this).attr('data-count');\n        var clone = $(\"#BcCcLoopSrc\" + srcFieldName).clone();\n\n        clone.find('input, select, textarea, hidden').each(function () {\n            $(this).attr('name', $(this).attr('name').replace('__loop-src__', count));\n            if($(this).attr('id') !== undefined) {\n                $(this).attr('id', $(this).attr('id').replace('loop-src', count));\n            }\n        });\n\n        // label for属性もループ番号に変更\n        clone.find('label').each(function () {\n            $(this).attr('for', $(this).attr('for').replace('loop-src', count));\n        });\n\n        const id = \"BcCcLoop\" + srcFieldName + '-' + count;\n        clone.attr('id', id);\n        clone.find('.btn-delete-loop').each(function () {\n            $(this).attr('data-delete-target', id);\n            $(this).click(customEntriesForm.deleteLoop);\n        });\n\n        $(\"#loop-\" + srcFieldName).append(clone);\n        clone.slideDown(150);\n        $(this).attr('data-count', Number(count) + 1);\n\n        $(\"#\" + id + \" .bca-text-counter-value\").remove();\n        $.bcUtil.setUpTextCounter(\"#\" + id + ' .bca-text-counter');\n    },\n\n    /**\n     * ループを削除する\n     */\n    deleteLoop() {\n        if (!confirm('ループブロックを削除します。本当によろしいですか？')) {\n            return;\n        }\n        $(\"#\" + $(this).attr('data-delete-target')).slideUp(150, function () {\n            $(this).remove();\n        });\n    }\n\n}\n\ncustomEntriesForm.mounted();\n\n"],"names":["customEntriesForm","fullUrl","mounted","this","$","attr","registerEvents","click","preview","addLoop","deleteLoop","window","open","form","parents","action","previewUrl","bcUtil","adminBaseUrl","tokenUrl","baseUrl","submit","get","result","val","srcFieldName","count","clone","find","each","replace","undefined","id","append","slideDown","Number","remove","setUpTextCounter","confirm","slideUp"],"sourceRoot":""}